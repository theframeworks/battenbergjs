"use strict"; module.exports = { MarzipanoViewer: require("./MarzipanoViewer"), DekstopViewer: require("./DesktopViewer"), VRViewer: require("./VRViewer"), Marzipano: require("marzipano"), utils: require("./utils") };
"use strict"; function _classCallCheck(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } function _defineProperties(e, t) { for (var n = 0; n < t.length; n++) { var i = t[n]; i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(e, i.key, i) } } function _createClass(e, t, n) { return t && _defineProperties(e.prototype, t), n && _defineProperties(e, n), e } var Marzipano = require("marzipano"), _require = require("./utils"), tiledImageSource = _require.tiledImageSource, isBelievedDesktop = _require.isBelievedDesktop, rad2deg = _require.rad2deg, deg2rad = _require.deg2rad, findSceneById = _require.findSceneById, findSceneDataById = _require.findSceneDataById; module.exports = function () { function s(e, t, n, i) { _classCallCheck(this, s), this.panoElement = t, this.environment = this.prepareEnvironment(e), this.initialScene = 0, this.rotationMaps = this.sceneTransitionRotationMapping(), this.Marzipano = Marzipano, this.sceneData = n, this.believedDesktop = isBelievedDesktop(e); var a = { controls: { mouseViewMode: this.sceneData.settings.mouseViewMode || !1, scrollZoom: !1 } }; this.viewer = new this.Marzipano.Viewer(this.panoElement, a), this.currentScene = null, this.defaultView = null, this.currentData = {}, this.currentContainers = [], this.currentLayers = [] } return _createClass(s, [{ key: "setupSceneBehaviour", value: function (e, t) { return this.scenes = this.createScenesFromData.call(this, this.sceneData.scenes, e, this.viewer), this.cacheSceneVariables(this.scenes[this.initialScene]), this.scenes } }, { key: "createScenesFromData", value: function (e, d, l) { var u = this; return e.map(function (e, t) { var n = tiledImageSource(e.id), i = new u.Marzipano.CubeGeometry(u.sceneData.cubeGeometryLevels), a = d.call(u, l, n, i, e), s = a.scene, o = a.view, c = a.containers, r = a.layers; return { data: a.data, scene: s, containers: c, layers: r, view: o } }) } }, { key: "cacheSceneVariables", value: function (e) { this.currentView = e.view, this.currentScene = e.scene, this.currentContainers = e.containers, this.currentData = e.data, this.currentLayers = e.layers } }, { key: "createLinkHotspotElement", value: function (e, t) { var n = this, i = document.createElement("div"); i.classList.add("hotspot"), i.classList.add("link-hotspot"); var a = document.createElement("img"); a.src = "icons/link.svg", a.classList.add("link-hotspot-icon"), i.addEventListener("click", function () { n.currentScene = t.call(n, findSceneById(e.target)) }), this.stopTouchAndScrollEventPropagation(i); var s = document.createElement("div"); s.classList.add("hotspot-tooltip"), s.classList.add("link-hotspot-tooltip"), i.appendChild(a), i.appendChild(s); var o = document.createElement("div"); return o.appendChild(i), o } }, { key: "createInfoHotspotElement", value: function (e) { var t = document.createElement("div"); t.setAttribute("data-info-hotspot-container-id", e.id); var n = document.createElement("div"); n.classList.add("hotspot"), n.classList.add("info-hotspot"); var i = document.createElement("div"); i.classList.add("info-hotspot-header"), i.setAttribute("data-info-hotspot-id", e.id); var a = document.createElement("div"); a.classList.add("info-hotspot-icon-wrapper"), i.appendChild(a); var s = document.createElement("div"); s.classList.add("info-hotspot-content"), s.setAttribute("data-info-hotspot-id", e.id); var o = document.getElementById("hotspot-".concat(e.id)); o && s.appendChild(o.cloneNode(!0)), e.hideInMobile && (n.classList.add("is-hidden-inline"), s.classList.add("is-hidden-inline")), n.appendChild(i), (this.believedDesktop ? this.panoElement : n).appendChild(s); var c = function (e) { var t = e.currentTarget.getAttribute("data-info-hotspot-id"); e.preventDefault(), document.querySelectorAll('[data-info-hotspot-id="'.concat(t, '"]')).forEach(function (e) { e.classList.toggle("is-visible"), e.classList.contains("is-visible") && document.querySelectorAll('[data-info-hotspot-container-id="'.concat(t, '"]')).forEach(function (e) { e.parentNode.appendChild(e) }) }) }; n.querySelector(".info-hotspot-header").addEventListener("click", c); var r = s.querySelector("[data-hotspot-close]"); return r && (r.setAttribute("data-info-hotspot-id", e.id), r.addEventListener("click", c)), this.stopTouchAndScrollEventPropagation(n), t.appendChild(n), t } }, { key: "stopTouchAndScrollEventPropagation", value: function (e) { for (var t = ["touchstart", "touchmove", "touchend", "touchcancel", "wheel", "mousewheel"], n = 0; n < t.length; n++)e.addEventListener(t[n], function (e) { e.stopPropagation() }) } }, { key: "prepareEnvironment", value: function (e) { if (window.matchMedia) { var t = function () { n.matches ? (document.body.classList.remove("desktop"), document.body.classList.add("mobile")) : (document.body.classList.remove("mobile"), document.body.classList.add("desktop")) }, n = matchMedia("(max-width: 500px), (max-height: 500px)"); t(), n.addListener(t) } else document.body.classList.add("desktop"); return e } }, { key: "getTransitionRotation", value: function (e, t) { return this.rotationMaps.from[e.id].to[t.id] } }, { key: "sceneTransitionRotationMapping", value: function () { return { from: { "scene-0": { to: { "scene-0": { yaw: 3.8, pitch: .22798880022457624 }, "scene-1": { yaw: -2.8274448996260446, pitch: .06012930486655321 } } }, "scene-1": { to: { "scene-0": { yaw: .145253345801045, pitch: .07 }, "scene-2": { yaw: -.14971585481837835, pitch: .07 }, "scene-3": { yaw: 2.6021574657373403, pitch: .09960663233749756 } } }, "scene-2": { to: { "scene-1": { yaw: 2.432133517575684, pitch: .07 } } }, "scene-3": { to: { "scene-1": { yaw: -.4469404282362994, pitch: .07244311540308956 }, "scene-4": { yaw: -1.3994865291876781, pitch: .05190705801597417 }, "scene-5": { yaw: 1.403211200196525, pitch: .07 } } }, "scene-4": { to: { "scene-3": { yaw: 1.0620391999023013, pitch: .07 } } }, "scene-5": { to: { "scene-3": { yaw: -.5201367601720577, pitch: .11417302060570478 } } } } } } }]), s }();
"use strict"; function _typeof(e) { return (_typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) { return typeof e } : function (e) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e })(e) } function _classCallCheck(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } function _defineProperties(e, t) { for (var r = 0; r < t.length; r++) { var o = t[r]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o) } } function _createClass(e, t, r) { return t && _defineProperties(e.prototype, t), r && _defineProperties(e, r), e } function _possibleConstructorReturn(e, t) { return !t || "object" !== _typeof(t) && "function" != typeof t ? _assertThisInitialized(e) : t } function _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e } function _get(e, t, r) { return (_get = "undefined" != typeof Reflect && Reflect.get ? Reflect.get : function (e, t, r) { var o = _superPropBase(e, t); if (o) { var n = Object.getOwnPropertyDescriptor(o, t); return n.get ? n.get.call(r) : n.value } })(e, t, r || e) } function _superPropBase(e, t) { for (; !Object.prototype.hasOwnProperty.call(e, t) && null !== (e = _getPrototypeOf(e));); return e } function _getPrototypeOf(e) { return (_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) { return e.__proto__ || Object.getPrototypeOf(e) })(e) } function _inherits(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function"); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } }), t && _setPrototypeOf(e, t) } function _setPrototypeOf(e, t) { return (_setPrototypeOf = Object.setPrototypeOf || function (e, t) { return e.__proto__ = t, e })(e, t) } var MarzipanoViewer = require("./MarzipanoViewer"), _require = require("./utils"), tiledImageSource = _require.tiledImageSource, isBelievedDesktop = _require.isBelievedDesktop, rad2deg = _require.rad2deg, findSceneById = _require.findSceneById, findSceneDataById = _require.findSceneDataById; module.exports = function (e) { function u(e, t) { var r; _classCallCheck(this, u), (r = _possibleConstructorReturn(this, _getPrototypeOf(u).call(this, "desktop", e, t))).autorotateData, r.firstLoad = !0, r.autorotateToggleElement = document.querySelector("#autorotateToggle"), r.sceneNameElement = document.querySelector("#titleBar .sceneName"); var o = r.setupSceneBehaviour(r.createScene, r.switchScene); return r.switchScene(o[r.initialScene]), r } return _inherits(u, MarzipanoViewer), _createClass(u, [{ key: "createScene", value: function (e, t, r, o) { var n = this, i = this.Marzipano.RectilinearView.limit.traditional(this.sceneData.faceSize, deg2rad(100), deg2rad(120)), a = new this.Marzipano.RectilinearView(o.initialViewParameters, i), c = e.createScene({ source: t, geometry: r, view: a, pinFirstLevel: !0 }), s = c.hotspotContainer(); return o.linkHotspots.forEach(function (e) { var t = _get(_getPrototypeOf(u.prototype), "createLinkHotspotElement", n).call(n, e, n.switchScene); s.createHotspot(t, { yaw: e.yaw, pitch: e.pitch }) }), o.infoHotspots.forEach(function (e) { var t = _get(_getPrototypeOf(u.prototype), "createInfoHotspotElement", n).call(n, e, n.panoElement); s.createHotspot(t, { yaw: e.yaw, pitch: e.pitch }) }), { scene: c, view: a, data: o } } }, { key: "switchScene", value: function (e) { var t = this.firstLoad ? e.data.initialViewParameters : this.getTransitionRotation(this.currentData, e.data); this.firstLoad = !1, e.view.setParameters(t), this.cacheSceneVariables.call(this, e), e.scene.switchTo() } }]), u }();
"use strict"; function _typeof(t) { return (_typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t })(t) } function _toConsumableArray(t) { return _arrayWithoutHoles(t) || _iterableToArray(t) || _nonIterableSpread() } function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance") } function _iterableToArray(t) { if (Symbol.iterator in Object(t) || "[object Arguments]" === Object.prototype.toString.call(t)) return Array.from(t) } function _arrayWithoutHoles(t) { if (Array.isArray(t)) { for (var e = 0, o = new Array(t.length); e < t.length; e++)o[e] = t[e]; return o } } function _classCallCheck(t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") } function _defineProperties(t, e) { for (var o = 0; o < e.length; o++) { var r = e[o]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(t, r.key, r) } } function _createClass(t, e, o) { return e && _defineProperties(t.prototype, e), o && _defineProperties(t, o), t } function _possibleConstructorReturn(t, e) { return !e || "object" !== _typeof(e) && "function" != typeof e ? _assertThisInitialized(t) : e } function _assertThisInitialized(t) { if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return t } function _get(t, e, o) { return (_get = "undefined" != typeof Reflect && Reflect.get ? Reflect.get : function (t, e, o) { var r = _superPropBase(t, e); if (r) { var n = Object.getOwnPropertyDescriptor(r, e); return n.get ? n.get.call(o) : n.value } })(t, e, o || t) } function _superPropBase(t, e) { for (; !Object.prototype.hasOwnProperty.call(t, e) && null !== (t = _getPrototypeOf(t));); return t } function _getPrototypeOf(t) { return (_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function (t) { return t.__proto__ || Object.getPrototypeOf(t) })(t) } function _inherits(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), e && _setPrototypeOf(t, e) } function _setPrototypeOf(t, e) { return (_setPrototypeOf = Object.setPrototypeOf || function (t, e) { return t.__proto__ = e, t })(t, e) } var MarzipanoViewer = require("./MarzipanoViewer"), DeviceOrientationStrategy = require("./DeviceOrientationStrategy"), _require = require("./utils"), deg2rad = _require.deg2rad, clampOverflowRotation = _require.clampOverflowRotation; console.log(DeviceOrientationStrategy), module.exports = function (t) { function f(t, e) { var o; _classCallCheck(this, f), (o = _possibleConstructorReturn(this, _getPrototypeOf(f).call(this, "mobileVR", t, e))).gyroEnabled, o.viewingTimeoutID = null, o.currentHotspotCandidate = null, o.openedHotspot = null, console.log(o.DeviceOrientationStrategy), o.lookTriggerThreshold = 1500, o.openPopupRadianThreshhold = deg2rad(5), o.closePopupHorizontalRadianThreshholdPerColumn = deg2rad(15), o.orientationMethodID = "deviceOrientation", o.deviceOrientationController; var r = o.setupSceneBehaviour(o.createScene, o.switchScene); return o.setupGyroControls(r), o.switchScene(r[o.initialScene]), o } return _inherits(f, MarzipanoViewer), _createClass(f, [{ key: "createScene", value: function (n, t, e, i) { var a = this, s = n.stage(), l = { source: t, geometry: e, textureStoreOpts: { previouslyVisibleCacheSize: 32 }, layerOpts: { effects: null } }, c = [], u = [], p = new this.Marzipano.RectilinearView(i.initialViewParameters), h = n.createEmptyScene({ view: p });[{ rect: { relativeWidth: .5, relativeX: 0 } }, { rect: { relativeWidth: .5, relativeX: .5 } }].forEach(function (t, e) { l.layerOpts.effects = t; var o = h.createLayer(l); o.eyeSide = 0 === e ? "left" : "right"; var r = new a.Marzipano.HotspotContainer(n.domElement(), s, p, n.renderLoop(), t); i.linkHotspots.forEach(function (t) { var e = _get(_getPrototypeOf(f.prototype), "createLinkHotspotElement", a).call(a, t, a.switchScene); e.dataset.hotspot_target = t.target, r.createHotspot(e, { yaw: t.yaw, pitch: t.pitch }) }), i.infoHotspots.forEach(function (t) { if (!t.hideInVR) { var e = _get(_getPrototypeOf(f.prototype), "createInfoHotspotElement", a).call(a, t, o); e.dataset.hotspot_target = t.id, r.createHotspot(e, { yaw: t.yaw, pitch: t.pitch }) } }), r.hide(), c.push(r), u.push(o) }), "scene-0" === i.id && this.showHotspotZero(c); var o = i.infoHotspots.filter(function (t) { return !1 === Object.keys(t).includes("hideInVR") }).filter(function (t) { return "0" !== t.id }).map(function (t) { return { yaw: t.yaw, pitch: t.pitch, target: t.id, columns: t.columns || 1 } }), r = i.linkHotspots.map(function (t) { return { yaw: t.yaw, pitch: t.pitch, target: t.target } }); return i.vrCollisionData = _toConsumableArray(o).concat(_toConsumableArray(r)), i.firstLoad = !0, { scene: h, view: p, containers: c, layers: u, data: i } } }, { key: "showHotspotZero", value: function (t) { var e = this.getHotspotsFromHotspotTarget(t, "0").leftHotspot.domElement(); this.clickInfoHotspot(e) } }, { key: "switchScene", value: function (t) { this.currentContainers.forEach(function (t) { t.hide() }), t.containers.forEach(function (t) { t.show() }), clearTimeout(this.viewingTimeoutID), this.viewingTimeoutID = null; var e = this.getTransitionRotation(this.currentData, t.data); t.view.setParameters(e), this.cacheSceneVariables.call(this, t), t.scene.switchTo({}, function () { }) } }, { key: "setupGyroControls", value: function (t) { var o = this; this.deviceOrientationController = new DeviceOrientationStrategy(this.Marzipano), this.Marzipano.dependencies.eventEmitter(DeviceOrientationStrategy); this.viewer.controls().registerMethod(this.orientationMethodID, this.deviceOrientationController, !0), this.deviceOrientationController.addEventListener("updatedYawPitchRoll", function (t, e) { o.computeLookDirection.call(o, e, o.currentScene, o.currentView) }) } }, { key: "setTimerClass", value: function (t) { this.panoElement.classList.toggle("is-opening", t) } }, { key: "clickInfoHotspot", value: function (t) { t.querySelector(".info-hotspot-header").click() } }, { key: "clickLinkHotspot", value: function (t) { t.querySelector(".link-hotspot").click() } }, { key: "minimumLookAtBounds", value: function (t, e) { var o = t.yaw - e.yaw, r = t.pitch - e.pitch; return { yawDiff: o, pitchDiff: r, lookAtUpperBound: o < this.openPopupRadianThreshhold && r < this.openPopupRadianThreshhold, lookAtLowerBound: o > -this.openPopupRadianThreshhold && r > -this.openPopupRadianThreshhold } } }, { key: "minimumLookAwayBounds", value: function (t, e) { var o = clampOverflowRotation(t.yaw - e.yaw); return { yawDiff: o, lookAwayMinimumUpperBound: o > this.closePopupHorizontalRadianThreshholdPerColumn * t.columns, lookAwayMinimumLowerBound: o < -this.closePopupHorizontalRadianThreshholdPerColumn * t.columns } } }, { key: "computeLookDirection", value: function (t, e, o) { var i = this, a = o.parameters(); if (this.currentHotspotCandidate || this.openedHotspot) { if (this.currentHotspotCandidate && !this.openedHotspot) { var r = this.currentHotspotCandidate, n = this.minimumLookAtBounds(r, a), s = (n.yawDiff, n.pitchDiff, n.lookAtUpperBound), l = n.lookAtLowerBound; if (!s || !l) return clearTimeout(this.viewingTimeoutID), this.viewingTimeoutID = null, this.openedHotspot = null, this.currentHotspotCandidate = null, void this.setTimerClass(!1) } else if (this.openedHotspot) { var c = this.openedHotspot, u = this.minimumLookAwayBounds(c, a), p = (u.yawDiff, u.lookAwayMinimumUpperBound); if (u.lookAwayMinimumLowerBound || p) { var h = this.getHotspotsFromHotspotTarget(this.currentContainers, c.target), f = h.leftHotspot, d = (h.rightHotspot, f.domElement()); this.clickInfoHotspot(d), clearTimeout(this.viewingTimeoutID), this.viewingTimeoutID = null, this.openedHotspot = null } } } else for (var y = this.currentData.vrCollisionData, m = function (t) { if (i.currentHotspotCandidate) return "continue"; var r = y[t], e = i.minimumLookAtBounds(r, a), o = (e.yawDiff, e.pitchDiff, e.lookAtUpperBound), n = e.lookAtLowerBound; o && n && (i.currentHotspotCandidate = r, i.viewingTimeoutID || (i.setTimerClass(!0), i.viewingTimeoutID = setTimeout(function () { var t = i.getHotspotsFromHotspotTarget(i.currentContainers, i.currentHotspotCandidate.target), e = t.leftHotspot, o = (t.rightHotspot, e.domElement()); i.setTimerClass(!1), i.viewingTimeoutID = null, o.dataset.hotspot_target.includes("scene") ? (i.openedHotspot = null, i.clickLinkHotspot(o)) : (i.openedHotspot = r, i.clickInfoHotspot(o)) }, i.lookTriggerThreshold))) }, g = 0; g < y.length; g++)m(g) } }, { key: "getHotspotsFromHotspotTarget", value: function (t, e) { for (var o = _toConsumableArray(t[0].listHotspots()), r = 0; r < o.length; r++) { if (o[r].domElement().dataset.hotspot_target == e) return { leftHotspot: o[r], rightHotspot: t[1].listHotspots()[r] } } console.error("no hotspot found?") } }]), f }();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIiwiTWFyemlwYW5vVmlld2VyLmpzIiwiRGVza3RvcFZpZXdlci5qcyIsIlZSVmlld2VyLmpzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJNYXJ6aXBhbm9WaWV3ZXIiLCJyZXF1aXJlIiwiRGVrc3RvcFZpZXdlciIsIlZSVmlld2VyIiwidXRpbHMiLCJNYXJ6aXBhbm8iLCJ0aWxlZEltYWdlU291cmNlIiwiaXNCZWxpZXZlZERlc2t0b3AiLCJyYWQyZGVnIiwiZGVnMnJhZCIsImZpbmRTY2VuZUJ5SWQiLCJmaW5kU2NlbmVEYXRhQnlJZCIsImVudmlyb25tZW50IiwicGFub0VsZW1lbnQiLCJzY2VuZURhdGEiLCJpbWFnZVNvdXJjZURpciIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJiZWxpZXZlZERlc2t0b3AiLCJ2aWV3ZXJPcHRzIiwiY29udHJvbHMiLCJtb3VzZVZpZXdNb2RlIiwic2V0dGluZ3MiLCJzY3JvbGxab29tIiwiVmlld2VyIiwiZGVmYXVsdFZpZXciLCJjdXJyZW50TGF5ZXJzIiwiX2NyZWF0ZUNsYXNzIiwia2V5IiwidmFsdWUiLCJzY2VuZUNyZWF0b3IiLCJzY2VuZVN3aXRjaGVyIiwiY3VycmVudFNjZW5lIiwiY3JlYXRlU2NlbmVzRnJvbURhdGEiLCJjYWxsIiwic2NlbmVzIiwidmlld2VyIiwiY3VycmVudERhdGEiLCJpbml0aWFsU2NlbmUiLCJfZGF0YSIsImNyZWF0ZVNjZW5lIiwiX3RoaXMiLCJtYXAiLCJtRGF0YSIsImkiLCJzb3VyY2UiLCJpZCIsImdlb21ldHJ5IiwiQ3ViZUdlb21ldHJ5IiwiY3ViZUdlb21ldHJ5TGV2ZWxzIiwiX2NyZWF0ZVNjZW5lJGNhbGwiLCJzY2VuZSIsInZpZXciLCJjb250YWluZXJzIiwibGF5ZXJzIiwiZGF0YSIsImN1cnJlbnRDb250YWluZXJzIiwiZ3JvdXBlZFNjZW5lRGF0YSIsImhvdHNwb3QiLCJzd2l0Y2hTY2VuZSIsIl90aGlzMiIsIndyYXBwZXIiLCJhZGQiLCJpY29uIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50Iiwic3JjIiwiY2xhc3NMaXN0IiwidGFyZ2V0IiwidG9vbHRpcCIsInN0b3BUb3VjaEFuZFNjcm9sbEV2ZW50UHJvcGFnYXRpb24iLCJhcHBlbmRDaGlsZCIsImNvbnRhaW5lciIsInNldEF0dHJpYnV0ZSIsImhlYWRlciIsImljb25XcmFwcGVyIiwiY29udGVudCIsImhvdHNwb3RFbGVtIiwiZ2V0RWxlbWVudEJ5SWQiLCJjb25jYXQiLCJoaWRlSW5Nb2JpbGUiLCJjbG9uZU5vZGUiLCJjdXJyZW50VGFyZ2V0IiwiZXZlbnQiLCJ0b2dnbGUiLCJlbGVtZW50IiwiY29udGFpbnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsInF1ZXJ5U2VsZWN0b3IiLCJjbG9zZUljb24iLCJwYXJlbnROb2RlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50TGlzdCIsImxlbmd0aCIsInN0b3BQcm9wYWdhdGlvbiIsImJvZHkiLCJ3aW5kb3ciLCJtYXRjaE1lZGlhIiwic2V0TW9kZSIsIm1xbCIsIm1hdGNoZXMiLCJyZW1vdmUiLCJhZGRMaXN0ZW5lciIsInJvdGF0aW9uTWFwcyIsImVudiIsImZyb20iLCJ0byIsInNjZW5lLTAiLCJ5YXciLCJwaXRjaCIsInNjZW5lLTEiLCJzY2VuZS0yIiwic2NlbmUtMyIsInNjZW5lLTQiLCJzY2VuZS01IiwiX01hcnppcGFub1ZpZXdlciIsIkRlc2t0b3BWaWV3ZXIiLCJjb25maWdEYXRhIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iLCJfZ2V0UHJvdG90eXBlT2YiLCJhdXRvcm90YXRlRGF0YSIsImZpcnN0TG9hZCIsImF1dG9yb3RhdGVUb2dnbGVFbGVtZW50Iiwic2NlbmVOYW1lRWxlbWVudCIsInNldHVwU2NlbmVCZWhhdmlvdXIiLCJfaW5oZXJpdHMiLCJsaW1pdGVyIiwiUmVjdGlsaW5lYXJWaWV3IiwibGltaXQiLCJ0cmFkaXRpb25hbCIsImluaXRpYWxWaWV3UGFyYW1ldGVycyIsInBpbkZpcnN0TGV2ZWwiLCJob3RzcG90Q29udGFpbmVyIiwibGlua0hvdHNwb3RzIiwiX2dldCIsInByb3RvdHlwZSIsImNyZWF0ZUhvdHNwb3QiLCJpbmZvSG90c3BvdHMiLCJhbHRlcmVkVmlld1BhcmFtcyIsImdldFRyYW5zaXRpb25Sb3RhdGlvbiIsInNldFBhcmFtZXRlcnMiLCJEZXZpY2VPcmllbnRhdGlvblN0cmF0ZWd5IiwiY2xhbXBPdmVyZmxvd1JvdGF0aW9uIiwiY29uc29sZSIsImxvZyIsImd5cm9FbmFibGVkIiwidmlld2luZ1RpbWVvdXRJRCIsImN1cnJlbnRIb3RzcG90Q2FuZGlkYXRlIiwib3BlbmVkSG90c3BvdCIsImxvb2tUcmlnZ2VyVGhyZXNob2xkIiwib3BlblBvcHVwUmFkaWFuVGhyZXNoaG9sZCIsImNsb3NlUG9wdXBIb3Jpem9udGFsUmFkaWFuVGhyZXNoaG9sZFBlckNvbHVtbiIsIm9yaWVudGF0aW9uTWV0aG9kSUQiLCJkZXZpY2VPcmllbnRhdGlvbkNvbnRyb2xsZXIiLCJzZXR1cEd5cm9Db250cm9scyIsIm9wdHMiLCJ0ZXh0dXJlU3RvcmVPcHRzIiwicHJldmlvdXNseVZpc2libGVDYWNoZVNpemUiLCJsYXllck9wdHMiLCJlZmZlY3RzIiwiZW1wdHlWaWV3IiwicmVjdCIsInJlbGF0aXZlV2lkdGgiLCJyZWxhdGl2ZVgiLCJsYXllciIsImNyZWF0ZUxheWVyIiwiZXllU2lkZSIsImluZGV4IiwiSG90c3BvdENvbnRhaW5lciIsImRvbUVsZW1lbnQiLCJzdGFnZSIsInJlbmRlckxvb3AiLCJsZWZ0UmlnaHRSZWN0cyIsImhvdHNwb3REYXRhIiwiaG90c3BvdF90YXJnZXQiLCJoaWRlSW5WUiIsImRhdGFzZXQiLCJwdXNoIiwic2hvd0hvdHNwb3RaZXJvIiwiaWgiLCJmaWx0ZXIiLCJjb2x1bW5zIiwibGlua0RhdGEiLCJsZWZ0RWxlbWVudCIsImdldEhvdHNwb3RzRnJvbUhvdHNwb3RUYXJnZXQiLCJsZWZ0SG90c3BvdCIsImNsaWNrSW5mb0hvdHNwb3QiLCJjIiwic2hvdyIsImNsZWFyVGltZW91dCIsIl90aGlzMyIsImV2ZW50RW1pdHRlciIsInJlZ2lzdGVyTWV0aG9kIiwiXyIsInJvdGF0aW9uIiwiY29tcHV0ZUxvb2tEaXJlY3Rpb24iLCJjdXJyZW50VmlldyIsIm9uIiwiY2xpY2siLCJzcG90IiwicGFyYW1zIiwieWF3RGlmZiIsInBpdGNoRGlmZiIsImxvb2tBdFVwcGVyQm91bmQiLCJsb29rQXRMb3dlckJvdW5kIiwibG9va0F3YXlNaW5pbXVtVXBwZXJCb3VuZCIsImxvb2tBd2F5TWluaW11bUxvd2VyQm91bmQiLCJfdGhpczQiLCJwYXJhbWV0ZXJzIiwiaG90c3BvdHMiLCJfdGhpcyRtaW5pbXVtTG9va0F0Qm8iLCJtaW5pbXVtTG9va0F0Qm91bmRzIiwic2V0VGltZXJDbGFzcyIsIm1pbmltdW1Mb29rQXdheUJvdW5kcyIsInJpZ2h0SG90c3BvdCIsInZyQ29sbGlzaW9uRGF0YSIsIl9sb29wIiwiX3RoaXM0JG1pbmltdW1Mb29rQXRCIiwic2V0VGltZW91dCIsIl90aGlzNCRnZXRIb3RzcG90c0ZybyIsImluY2x1ZGVzIiwiY2xpY2tMaW5rSG90c3BvdCIsIl90b0NvbnN1bWFibGVBcnJheSIsImxpc3RIb3RzcG90cyIsImVycm9yIl0sIm1hcHBpbmdzIjoiYUFFQUEsT0FBT0MsUUFBVSxDQUNiQyxnQkFBaUJDLFFBQVEscUJBQ3pCQyxjQUFlRCxRQUFRLG1CQUN2QkUsU0FBVUYsUUFBUSxjQUlsQkcsVUFBT0gsUUFBUSxhQUFmRyxNQUFPSCxRQUFRO21aQ1RuQixJQUFNSSxVQUFZSixRQUFRLHNCQUMwRUEsUUFBUSxXQUFwR0ssMEJBQUFBLGlCQUFrQkMsMkJBQUFBLGtCQUFtQkMsaUJBQUFBLFFBQVNDLGlCQUFBQSxRQUFTQyx1QkFBQUEsY0FBZUMsMkJBQUFBLGtCQUU5RWIsT0FBT0MsUUFBUCxXQU9FLFNBQUFDLEVBQVlZLEVBVDhGQyxFQVNwRUMsRUFBV0MsR0FBZ0JDLGdCQUFBQyxLQUFBakIsR0FUekNPLEtBQUFBLFlBV0hNLEVBWHNCTCxL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QUE4SCxhQUVKTyxRQUFBRixnQkFBQTNHLEVBdURILE1BQU8sQ0FBRXNILFlBdERSd0IsRUFBQXRLLEdBc0QyQjJLLGFBckcwQmxLLEVBQUEsR0FBQTJLLGVBQUFwTCxJQWdEdkRvRyxRQUFBaUYsTUFBQSx5QkF0U1A5TixFQUFBIiwiZmlsZSI6ImJhdHRlbmJ1cmcuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgTWFyemlwYW5vVmlld2VyOiByZXF1aXJlKCcuL01hcnppcGFub1ZpZXdlcicpLFxuICAgIERla3N0b3BWaWV3ZXI6IHJlcXVpcmUoJy4vRGVza3RvcFZpZXdlcicpLFxuICAgIFZSVmlld2VyOiByZXF1aXJlKCcuL1ZSVmlld2VyJyksXG5cbiAgICBNYXJ6aXBhbm86IHJlcXVpcmUoJ21hcnppcGFubycpLFxuXG4gICAgdXRpbHM6IHJlcXVpcmUoJy4vdXRpbHMnKVxufSIsImNvbnN0IE1hcnppcGFubyA9IHJlcXVpcmUoJ21hcnppcGFubycpO1xuY29uc3QgeyB0aWxlZEltYWdlU291cmNlLCBpc0JlbGlldmVkRGVza3RvcCwgcmFkMmRlZywgZGVnMnJhZCwgZmluZFNjZW5lQnlJZCwgZmluZFNjZW5lRGF0YUJ5SWQgfSA9IHJlcXVpcmUoJy4vdXRpbHMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBjbGFzcyBNYXJ6aXBhbm9WaWV3ZXIge1xuXG4gIC8qKlxuICAgKiBcbiAgICogQHBhcmFtIHtzdHJpbmd9IGVudmlyb25tZW50IFxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IHBhbm9FbGVtZW50IC0gSW5qZWN0ZWQgYnkgdGhlIHZpZXdTd2l0Y2ggZmlsZSB3aXRoIGVpdGhlciB0aGUgVlIgb3IgRGVza3RvcCBwYW5vRWxlbWVudFxuICAgKi9cbiAgY29uc3RydWN0b3IoZW52aXJvbm1lbnQsIHBhbm9FbGVtZW50LCBzY2VuZURhdGEsIGltYWdlU291cmNlRGlyKSB7XG5cbiAgICB0aGlzLnBhbm9FbGVtZW50ID0gcGFub0VsZW1lbnQ7XG4gICAgdGhpcy5lbnZpcm9ubWVudCA9IHRoaXMucHJlcGFyZUVudmlyb25tZW50KGVudmlyb25tZW50KTtcbiAgICB0aGlzLmluaXRpYWxTY2VuZSA9IDA7XG4gICAgdGhpcy5yb3RhdGlvbk1hcHMgPSB0aGlzLnNjZW5lVHJhbnNpdGlvblJvdGF0aW9uTWFwcGluZygpO1xuXG5cbiAgICB0aGlzLk1hcnppcGFubyA9IE1hcnppcGFubztcbiAgICB0aGlzLnNjZW5lRGF0YSA9IHNjZW5lRGF0YTtcblxuICAgIHRoaXMuYmVsaWV2ZWREZXNrdG9wID0gaXNCZWxpZXZlZERlc2t0b3AoZW52aXJvbm1lbnQpO1xuXG4gICAgLy8gVmlld2VyIG9wdGlvbnMuIENob2ljZXMgaGVyZTogaHR0cDovL3d3dy5tYXJ6aXBhbm8ubmV0L3JlZmVyZW5jZS9nbG9iYWwuaHRtbCNyZWdpc3RlckRlZmF1bHRDb250cm9sc1xuICAgIGxldCB2aWV3ZXJPcHRzID0ge1xuICAgICAgY29udHJvbHM6IHtcbiAgICAgICAgLy8gV2UnbGwgZGVmYXVsdCB0byBtb3VzZS9wb2ludGVyIGNvbnRyb2wsIEkgY2FuIHR1cm4gb24gVlIgZ3lybyBjb250cm9sIG9uIHVzZXIgZGVtYW5kLlxuICAgICAgICBtb3VzZVZpZXdNb2RlOiB0aGlzLnNjZW5lRGF0YS5zZXR0aW5ncy5tb3VzZVZpZXdNb2RlIHx8IGZhbHNlLFxuICAgICAgICBzY3JvbGxab29tOiBmYWxzZSxcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gSW5pdGlhbGl6ZSB2aWV3ZXIuXG4gICAgdGhpcy52aWV3ZXIgPSBuZXcgdGhpcy5NYXJ6aXBhbm8uVmlld2VyKHRoaXMucGFub0VsZW1lbnQsIHZpZXdlck9wdHMpO1xuXG4gICAgdGhpcy5jdXJyZW50U2NlbmUgPSBudWxsO1xuICAgIHRoaXMuZGVmYXVsdFZpZXcgPSBudWxsO1xuICAgIHRoaXMuY3VycmVudERhdGEgPSB7fTtcbiAgICB0aGlzLmN1cnJlbnRDb250YWluZXJzID0gW107XG4gICAgdGhpcy5jdXJyZW50TGF5ZXJzID0gW107XG4gIH1cblxuXG4gIHNldHVwU2NlbmVCZWhhdmlvdXIoc2NlbmVDcmVhdG9yLCBzY2VuZVN3aXRjaGVyKSB7XG5cbiAgICAvLyBDcmVhdGUgc2NlbmVzIHVzaW5nIHRoZSBwcm92aWRlZCBkYXRhIGpzb25cbiAgICB0aGlzLnNjZW5lcyA9IHRoaXMuY3JlYXRlU2NlbmVzRnJvbURhdGEuY2FsbCh0aGlzLCB0aGlzLnNjZW5lRGF0YS5zY2VuZXMsIHNjZW5lQ3JlYXRvciwgdGhpcy52aWV3ZXIpO1xuXG4gICAgdGhpcy5jYWNoZVNjZW5lVmFyaWFibGVzKHRoaXMuc2NlbmVzW3RoaXMuaW5pdGlhbFNjZW5lXSk7XG5cbiAgICByZXR1cm4gdGhpcy5zY2VuZXM7XG4gIH1cblxuXG5cbiAgLyoqXG4gICAqIFxuICAgKiBAcGFyYW0ge1tdfSBfZGF0YSBcbiAgICogQHBhcmFtIHsoKSA9PiB7fX0gc2NlbmVDcmVhdG9yIFxuICAgKi9cbiAgY3JlYXRlU2NlbmVzRnJvbURhdGEoX2RhdGEsIGNyZWF0ZVNjZW5lLCB2aWV3ZXIpIHtcblxuICAgIHJldHVybiBfZGF0YS5tYXAoKG1EYXRhLCBpKSA9PiB7XG5cblxuICAgICAgLy8gWzFdIGdldCB0aGUgaW1hZ2VzXG4gICAgICBjb25zdCBzb3VyY2UgPSB0aWxlZEltYWdlU291cmNlKG1EYXRhLmlkKTtcblxuICAgICAgLy8gWzJdIENyZWF0ZSB0aGUgZ2VvbWV0cnlcbiAgICAgIGxldCBnZW9tZXRyeSA9IG5ldyB0aGlzLk1hcnppcGFuby5DdWJlR2VvbWV0cnkodGhpcy5zY2VuZURhdGEuY3ViZUdlb21ldHJ5TGV2ZWxzKTtcblxuICAgICAgLy8gVE9ETzogTWF5YmUgbW92ZSB0aGUgZ3JvdXBlZFNjZW5lRGF0YSByZXR1cm4gb2JqZWN0IGludG8gaXQuXG4gICAgICAvLyBUaGVuIGRlc2t0b3AgY2FuIHJldHVybiBTY2VuZSBhbmQgVlIgY2FuIHJldHVybiBTdGFnZS4gRG9lcyBpdCBldmVuIG1hdHRlciB0aG91Z2g/XG4gICAgICBjb25zdCB7IHNjZW5lLCB2aWV3LCBjb250YWluZXJzLCBsYXllcnMsIGRhdGEgfSA9IGNyZWF0ZVNjZW5lLmNhbGwodGhpcywgdmlld2VyLCBzb3VyY2UsIGdlb21ldHJ5LCBtRGF0YSk7XG5cbiAgICAgIGNvbnN0IGdyb3VwZWRTY2VuZURhdGEgPSB7XG4gICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgIHNjZW5lOiBzY2VuZSxcbiAgICAgICAgY29udGFpbmVyczogY29udGFpbmVycyxcbiAgICAgICAgbGF5ZXJzOiBsYXllcnMsXG4gICAgICAgIHZpZXc6IHZpZXdcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiBncm91cGVkU2NlbmVEYXRhO1xuICAgIH0pO1xuICB9XG5cblxuICBjYWNoZVNjZW5lVmFyaWFibGVzKHNjZW5lKSB7XG5cbiAgICAvLyAvLyBEb3VidCBJJ2xsIG5lZWQgdGhpcy4gQ291bGQgcHJvdmUgdXNlZnVsIGZvciBzb21lIGxheWVyIG1hbmlwdWxhdGlvbiB0aG91Z2g/XG4gICAgdGhpcy5jdXJyZW50VmlldyA9IHNjZW5lLnZpZXc7XG4gICAgdGhpcy5jdXJyZW50U2NlbmUgPSBzY2VuZS5zY2VuZTtcbiAgICB0aGlzLmN1cnJlbnRDb250YWluZXJzID0gc2NlbmUuY29udGFpbmVycztcbiAgICB0aGlzLmN1cnJlbnREYXRhID0gc2NlbmUuZGF0YTtcbiAgICB0aGlzLmN1cnJlbnRMYXllcnMgPSBzY2VuZS5sYXllcnM7XG4gIH1cblxuXG4gIGNyZWF0ZUxpbmtIb3RzcG90RWxlbWVudChob3RzcG90LCBzd2l0Y2hTY2VuZSkge1xuXG4gICAgLy8gQ3JlYXRlIHdyYXBwZXIgZWxlbWVudCB0byBob2xkIGljb24gYW5kIHRvb2x0aXAuXG4gICAgbGV0IHdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB3cmFwcGVyLmNsYXNzTGlzdC5hZGQoJ2hvdHNwb3QnKTtcbiAgICB3cmFwcGVyLmNsYXNzTGlzdC5hZGQoJ2xpbmstaG90c3BvdCcpO1xuXG4gICAgLy8gQ3JlYXRlIGltYWdlIGVsZW1lbnQuXG4gICAgbGV0IGljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcbiAgICBpY29uLnNyYyA9ICdpY29ucy9saW5rLnN2Zyc7XG4gICAgaWNvbi5jbGFzc0xpc3QuYWRkKCdsaW5rLWhvdHNwb3QtaWNvbicpO1xuXG4gICAgLy8gQWRkIGNsaWNrIGV2ZW50IGhhbmRsZXIuXG4gICAgd3JhcHBlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuY3VycmVudFNjZW5lID0gc3dpdGNoU2NlbmUuY2FsbCh0aGlzLCBmaW5kU2NlbmVCeUlkKGhvdHNwb3QudGFyZ2V0KSk7XG4gICAgfSk7XG5cbiAgICAvLyBQcmV2ZW50IHRvdWNoIGFuZCBzY3JvbGwgZXZlbnRzIGZyb20gcmVhY2hpbmcgdGhlIHBhcmVudCBlbGVtZW50LlxuICAgIC8vIFRoaXMgcHJldmVudHMgdGhlIHZpZXcgY29udHJvbCBsb2dpYyBmcm9tIGludGVyZmVyaW5nIHdpdGggdGhlIGhvdHNwb3QuXG4gICAgdGhpcy5zdG9wVG91Y2hBbmRTY3JvbGxFdmVudFByb3BhZ2F0aW9uKHdyYXBwZXIpO1xuXG4gICAgLy8gQ3JlYXRlIHRvb2x0aXAgZWxlbWVudC5cbiAgICBsZXQgdG9vbHRpcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRvb2x0aXAuY2xhc3NMaXN0LmFkZCgnaG90c3BvdC10b29sdGlwJyk7XG4gICAgdG9vbHRpcC5jbGFzc0xpc3QuYWRkKCdsaW5rLWhvdHNwb3QtdG9vbHRpcCcpO1xuXG4gICAgd3JhcHBlci5hcHBlbmRDaGlsZChpY29uKTtcbiAgICB3cmFwcGVyLmFwcGVuZENoaWxkKHRvb2x0aXApO1xuXG4gICAgbGV0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh3cmFwcGVyKTtcblxuICAgIHJldHVybiBjb250YWluZXI7XG4gIH1cblxuXG4gIGNyZWF0ZUluZm9Ib3RzcG90RWxlbWVudChob3RzcG90KSB7XG5cbiAgICBsZXQgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnZGF0YS1pbmZvLWhvdHNwb3QtY29udGFpbmVyLWlkJywgaG90c3BvdC5pZCk7XG5cbiAgICAvLyBDcmVhdGUgd3JhcHBlciBlbGVtZW50IHRvIGhvbGQgaWNvbiBhbmQgdG9vbHRpcC5cbiAgICBsZXQgd3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHdyYXBwZXIuY2xhc3NMaXN0LmFkZCgnaG90c3BvdCcpO1xuICAgIHdyYXBwZXIuY2xhc3NMaXN0LmFkZCgnaW5mby1ob3RzcG90Jyk7XG5cbiAgICAvLyBDcmVhdGUgaG90c3BvdC90b29sdGlwIGhlYWRlci5cbiAgICBsZXQgaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgaGVhZGVyLmNsYXNzTGlzdC5hZGQoJ2luZm8taG90c3BvdC1oZWFkZXInKTtcbiAgICBoZWFkZXIuc2V0QXR0cmlidXRlKCdkYXRhLWluZm8taG90c3BvdC1pZCcsIGhvdHNwb3QuaWQpO1xuXG4gICAgLy8gQ3JlYXRlIGltYWdlIGVsZW1lbnQgZm9yIHRoZSBsaXR0bGUgaWNvbi5cbiAgICBsZXQgaWNvbldyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBpY29uV3JhcHBlci5jbGFzc0xpc3QuYWRkKCdpbmZvLWhvdHNwb3QtaWNvbi13cmFwcGVyJyk7XG5cbiAgICAvLyBDb25zdHJ1Y3QgaGVhZGVyIGVsZW1lbnQuXG4gICAgaGVhZGVyLmFwcGVuZENoaWxkKGljb25XcmFwcGVyKTtcblxuICAgIC8vIEFkZCBjb250ZW50IHRvIHRoZSBjb250ZW50IGNvbnRhaW5lclxuICAgIGxldCBjb250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29udGVudC5jbGFzc0xpc3QuYWRkKCdpbmZvLWhvdHNwb3QtY29udGVudCcpO1xuICAgIGNvbnRlbnQuc2V0QXR0cmlidXRlKCdkYXRhLWluZm8taG90c3BvdC1pZCcsIGhvdHNwb3QuaWQpO1xuXG4gICAgbGV0IGhvdHNwb3RFbGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYGhvdHNwb3QtJHtob3RzcG90LmlkfWApO1xuICAgIGlmIChob3RzcG90RWxlbSkge1xuICAgICAgY29udGVudC5hcHBlbmRDaGlsZChob3RzcG90RWxlbS5jbG9uZU5vZGUodHJ1ZSkpO1xuICAgIH1cblxuICAgIGlmIChob3RzcG90LmhpZGVJbk1vYmlsZSkge1xuICAgICAgd3JhcHBlci5jbGFzc0xpc3QuYWRkKCdpcy1oaWRkZW4taW5saW5lJyk7XG4gICAgICBjb250ZW50LmNsYXNzTGlzdC5hZGQoJ2lzLWhpZGRlbi1pbmxpbmUnKTtcbiAgICB9XG5cblxuICAgIC8vIFBsYWNlIGhlYWRlciBpbnRvIHdyYXBwZXIgZWxlbWVudC5cbiAgICB3cmFwcGVyLmFwcGVuZENoaWxkKGhlYWRlcik7XG4gICAgKHRoaXMuYmVsaWV2ZWREZXNrdG9wID8gdGhpcy5wYW5vRWxlbWVudCA6IHdyYXBwZXIpLmFwcGVuZENoaWxkKGNvbnRlbnQpO1xuXG5cblxuICAgIGxldCB0b2dnbGUgPSAoZXZlbnQpID0+IHtcbiAgICAgIGxldCBpZCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLWluZm8taG90c3BvdC1pZCcpO1xuXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGBbZGF0YS1pbmZvLWhvdHNwb3QtaWQ9XCIke2lkfVwiXWApLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCdpcy12aXNpYmxlJyk7XG5cbiAgICAgICAgLy8gcmVhcHBlbmRpbmcgdGhlIG9wZW4gaG90c3BvdCBicmluZ3MgaXQgb24gdG9wIG9mIG90aGVyIGhvdHNwb3RzXG4gICAgICAgIC8vIHBsYXlpbmcgd2l0aCB6LWluZGV4IHdvdWxkbid0IHdvcmsgYXMgd2UgYXJlIGRlYWxpbmcgd2l0aCB0cmFuc2Zvcm1lZCBlbGVtZW50c1xuICAgICAgICBpZiAoZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2lzLXZpc2libGUnKSkge1xuICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYFtkYXRhLWluZm8taG90c3BvdC1jb250YWluZXItaWQ9XCIke2lkfVwiXWApLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIGVsZW1lbnQucGFyZW50Tm9kZS5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8vIFNob3cgY29udGVudCB3aGVuIGhvdHNwb3QgaXMgY2xpY2tlZC5cbiAgICB3cmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy5pbmZvLWhvdHNwb3QtaGVhZGVyJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGUpO1xuXG4gICAgbGV0IGNsb3NlSWNvbiA9IGNvbnRlbnQucXVlcnlTZWxlY3RvcignW2RhdGEtaG90c3BvdC1jbG9zZV0nKTtcbiAgICBpZiAoY2xvc2VJY29uKSB7XG4gICAgICBjbG9zZUljb24uc2V0QXR0cmlidXRlKCdkYXRhLWluZm8taG90c3BvdC1pZCcsIGhvdHNwb3QuaWQpO1xuICAgICAgY2xvc2VJY29uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlKTtcbiAgICB9XG5cbiAgICAvLyBQcmV2ZW50IHRvdWNoIGFuZCBzY3JvbGwgZXZlbnRzIGZyb20gcmVhY2hpbmcgdGhlIHBhcmVudCBlbGVtZW50LlxuICAgIC8vIFRoaXMgcHJldmVudHMgdGhlIHZpZXcgY29udHJvbCBsb2dpYyBmcm9tIGludGVyZmVyaW5nIHdpdGggdGhlIGhvdHNwb3QuXG4gICAgdGhpcy5zdG9wVG91Y2hBbmRTY3JvbGxFdmVudFByb3BhZ2F0aW9uKHdyYXBwZXIpO1xuXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHdyYXBwZXIpO1xuXG4gICAgcmV0dXJuIGNvbnRhaW5lcjtcbiAgfVxuXG4gIC8vIFByZXZlbnQgdG91Y2ggYW5kIHNjcm9sbCBldmVudHMgZnJvbSByZWFjaGluZyB0aGUgcGFyZW50IGVsZW1lbnQuXG4gIHN0b3BUb3VjaEFuZFNjcm9sbEV2ZW50UHJvcGFnYXRpb24oZWxlbWVudCkge1xuICAgIGxldCBldmVudExpc3QgPSBbJ3RvdWNoc3RhcnQnLCAndG91Y2htb3ZlJywgJ3RvdWNoZW5kJywgJ3RvdWNoY2FuY2VsJywgJ3doZWVsJywgJ21vdXNld2hlZWwnXTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZXZlbnRMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnRMaXN0W2ldLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBlbnYgXG4gICAqL1xuICBwcmVwYXJlRW52aXJvbm1lbnQoZW52KSB7XG5cbiAgICBpZiAod2luZG93Lm1hdGNoTWVkaWEpIHtcbiAgICAgIGxldCBzZXRNb2RlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBUaGUgdmlld3BvcnQgaXMsIGF0IG1vc3QgXG4gICAgICAgIGlmIChtcWwubWF0Y2hlcykge1xuICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnZGVza3RvcCcpO1xuICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnbW9iaWxlJyk7XG4gICAgICAgICAgLy8gZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSAnbW9iaWxlJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ21vYmlsZScpO1xuICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnZGVza3RvcCcpO1xuICAgICAgICAgIC8vIGRvY3VtZW50LmJvZHkuaW5uZXJIVE1MID0gJ2Rlc2t0b3AnO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgbGV0IG1xbCA9IG1hdGNoTWVkaWEoJyhtYXgtd2lkdGg6IDUwMHB4KSwgKG1heC1oZWlnaHQ6IDUwMHB4KScpO1xuICAgICAgc2V0TW9kZSgpO1xuICAgICAgbXFsLmFkZExpc3RlbmVyKHNldE1vZGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ2Rlc2t0b3AnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZW52O1xuICB9XG5cblxuICBnZXRUcmFuc2l0aW9uUm90YXRpb24oZnJvbSwgdG8pIHtcblxuICAgIHJldHVybiB0aGlzLnJvdGF0aW9uTWFwcy5mcm9tW2Zyb20uaWRdLnRvW3RvLmlkXTtcbiAgfVxuXG4gIC8vIENvdWxkIG1heWJlIGJlIG1hZGUgaW50byBhIGZpbGUgaW1wb3J0ZWQgaW4gdGhlIGJyb3dzZXIuIE9oIHdlbGwuXG4gIHNjZW5lVHJhbnNpdGlvblJvdGF0aW9uTWFwcGluZygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgJ2Zyb20nOiB7XG4gICAgICAgICdzY2VuZS0wJzoge1xuICAgICAgICAgICd0byc6IHtcbiAgICAgICAgICAgIC8vIFJlcXVpcmVkIGZvciBmaXJzdCBsb2FkLiBGcm9tIDAgdG8gMCBpcyBzaWxseSBidXQgZ28gd2l0aCBpdC5cbiAgICAgICAgICAgICdzY2VuZS0wJzoge1xuICAgICAgICAgICAgICAneWF3JzogMy44LFxuICAgICAgICAgICAgICAncGl0Y2gnOiAwLjIyNzk4ODgwMDIyNDU3NjI0LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICdzY2VuZS0xJzoge1xuICAgICAgICAgICAgICAneWF3JzogLTIuODI3NDQ0ODk5NjI2MDQ0NixcbiAgICAgICAgICAgICAgJ3BpdGNoJzogMC4wNjAxMjkzMDQ4NjY1NTMyMVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgJ3NjZW5lLTEnOiB7XG4gICAgICAgICAgJ3RvJzoge1xuICAgICAgICAgICAgJ3NjZW5lLTAnOiB7XG4gICAgICAgICAgICAgICd5YXcnOiAwLjE0NTI1MzM0NTgwMTA0NSxcbiAgICAgICAgICAgICAgJ3BpdGNoJzogMC4wN1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICdzY2VuZS0yJzoge1xuICAgICAgICAgICAgICAneWF3JzogLTAuMTQ5NzE1ODU0ODE4Mzc4MzUsXG4gICAgICAgICAgICAgICdwaXRjaCc6IDAuMDdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnc2NlbmUtMyc6IHtcbiAgICAgICAgICAgICAgJ3lhdyc6IDIuNjAyMTU3NDY1NzM3MzQwMyxcbiAgICAgICAgICAgICAgJ3BpdGNoJzogMC4wOTk2MDY2MzIzMzc0OTc1NlxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgJ3NjZW5lLTInOiB7XG4gICAgICAgICAgJ3RvJzoge1xuICAgICAgICAgICAgJ3NjZW5lLTEnOiB7XG4gICAgICAgICAgICAgICd5YXcnOiAyLjQzMjEzMzUxNzU3NTY4NCxcbiAgICAgICAgICAgICAgJ3BpdGNoJzogMC4wN1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgJ3NjZW5lLTMnOiB7XG4gICAgICAgICAgJ3RvJzoge1xuICAgICAgICAgICAgJ3NjZW5lLTEnOiB7XG4gICAgICAgICAgICAgICd5YXcnOiAtMC40NDY5NDA0MjgyMzYyOTk0LFxuICAgICAgICAgICAgICAncGl0Y2gnOiAwLjA3MjQ0MzExNTQwMzA4OTU2XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ3NjZW5lLTQnOiB7XG4gICAgICAgICAgICAgICd5YXcnOiAtMS4zOTk0ODY1MjkxODc2NzgxLFxuICAgICAgICAgICAgICAncGl0Y2gnOiAwLjA1MTkwNzA1ODAxNTk3NDE3XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ3NjZW5lLTUnOiB7XG4gICAgICAgICAgICAgICd5YXcnOiAxLjQwMzIxMTIwMDE5NjUyNSxcbiAgICAgICAgICAgICAgJ3BpdGNoJzogMC4wN1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgJ3NjZW5lLTQnOiB7XG4gICAgICAgICAgJ3RvJzoge1xuICAgICAgICAgICAgJ3NjZW5lLTMnOiB7XG4gICAgICAgICAgICAgICd5YXcnOiAxLjA2MjAzOTE5OTkwMjMwMTMsXG4gICAgICAgICAgICAgICdwaXRjaCc6IDAuMDdcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgICdzY2VuZS01Jzoge1xuICAgICAgICAgICd0byc6IHtcbiAgICAgICAgICAgICdzY2VuZS0zJzoge1xuICAgICAgICAgICAgICAneWF3JzogLTAuNTIwMTM2NzYwMTcyMDU3NyxcbiAgICAgICAgICAgICAgJ3BpdGNoJzogMC4xMTQxNzMwMjA2MDU3MDQ3OFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIiwiY29uc3QgTWFyemlwYW5vVmlld2VyID0gcmVxdWlyZSgnLi9NYXJ6aXBhbm9WaWV3ZXInKTtcbmNvbnN0IHsgdGlsZWRJbWFnZVNvdXJjZSwgaXNCZWxpZXZlZERlc2t0b3AsIHJhZDJkZWcsIGZpbmRTY2VuZUJ5SWQsIGZpbmRTY2VuZURhdGFCeUlkIH0gPSByZXF1aXJlKCcuL3V0aWxzJyk7XG5cblxuXG5tb2R1bGUuZXhwb3J0cyA9IGNsYXNzIERlc2t0b3BWaWV3ZXIgZXh0ZW5kcyBNYXJ6aXBhbm9WaWV3ZXIge1xuXG4gIGNvbnN0cnVjdG9yKHBhbm9FbGVtZW50LCBjb25maWdEYXRhKSB7XG4gICAgc3VwZXIoJ2Rlc2t0b3AnLCBwYW5vRWxlbWVudCwgY29uZmlnRGF0YSk7XG5cbiAgICB0aGlzLmF1dG9yb3RhdGVEYXRhO1xuICAgIHRoaXMuZmlyc3RMb2FkID0gdHJ1ZTtcblxuXG4gICAgdGhpcy5hdXRvcm90YXRlVG9nZ2xlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhdXRvcm90YXRlVG9nZ2xlJyk7XG4gICAgdGhpcy5zY2VuZU5hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3RpdGxlQmFyIC5zY2VuZU5hbWUnKTtcblxuICAgIGNvbnN0IGdyb3VwZWRTY2VuZURhdGEgPSB0aGlzLnNldHVwU2NlbmVCZWhhdmlvdXIodGhpcy5jcmVhdGVTY2VuZSwgdGhpcy5zd2l0Y2hTY2VuZSk7XG5cbiAgICB0aGlzLnN3aXRjaFNjZW5lKGdyb3VwZWRTY2VuZURhdGFbdGhpcy5pbml0aWFsU2NlbmVdKTtcbiAgfVxuXG4gIGNyZWF0ZVNjZW5lKHZpZXdlciwgc291cmNlLCBnZW9tZXRyeSwgZGF0YSkge1xuXG4gICAgLy8gWzNdIENyZWF0ZSB0aGUgXCJleWVzXCIgb3Igdmlldy5cbiAgICBsZXQgbGltaXRlciA9IHRoaXMuTWFyemlwYW5vLlJlY3RpbGluZWFyVmlldy5saW1pdC50cmFkaXRpb25hbChcbiAgICAgIHRoaXMuc2NlbmVEYXRhLmZhY2VTaXplLFxuICAgICAgZGVnMnJhZCgxMDApLFxuICAgICAgZGVnMnJhZCgxMjApKTtcbiAgICBjb25zdCB2aWV3ID0gbmV3IHRoaXMuTWFyemlwYW5vLlJlY3RpbGluZWFyVmlldyhkYXRhLmluaXRpYWxWaWV3UGFyYW1ldGVycywgbGltaXRlcik7XG5cbiAgICAvLyBUaGUgY3VycmVudCBzY2VuZSBkb2VzIG5vdCBjaGFuZ2Ugd2hlbiBjcmVhdGluZyBhIHNjZW5lIGluIHRoaXMgd2F5LlxuICAgIGNvbnN0IHNjZW5lID0gdmlld2VyLmNyZWF0ZVNjZW5lKHtcbiAgICAgIHNvdXJjZTogc291cmNlLFxuICAgICAgZ2VvbWV0cnk6IGdlb21ldHJ5LFxuICAgICAgdmlldzogdmlldyxcbiAgICAgIHBpbkZpcnN0TGV2ZWw6IHRydWVcbiAgICB9KTtcblxuICAgIGNvbnN0IGhvdHNwb3RDb250YWluZXIgPSBzY2VuZS5ob3RzcG90Q29udGFpbmVyKCk7XG4gICAgLy8gQ3JlYXRlIGxpbmsgaG90c3BvdHMuXG4gICAgZGF0YS5saW5rSG90c3BvdHMuZm9yRWFjaCgoaG90c3BvdCkgPT4ge1xuICAgICAgbGV0IGVsZW1lbnQgPSBzdXBlci5jcmVhdGVMaW5rSG90c3BvdEVsZW1lbnQuY2FsbCh0aGlzLCBob3RzcG90LCB0aGlzLnN3aXRjaFNjZW5lKTtcbiAgICAgIGhvdHNwb3RDb250YWluZXIuY3JlYXRlSG90c3BvdChlbGVtZW50LCB7IHlhdzogaG90c3BvdC55YXcsIHBpdGNoOiBob3RzcG90LnBpdGNoIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gQ3JlYXRlIGluZm8gaG90c3BvdHMuXG4gICAgZGF0YS5pbmZvSG90c3BvdHMuZm9yRWFjaCgoaG90c3BvdCkgPT4ge1xuICAgICAgbGV0IGVsZW1lbnQgPSBzdXBlci5jcmVhdGVJbmZvSG90c3BvdEVsZW1lbnQoaG90c3BvdCwgdGhpcy5wYW5vRWxlbWVudCk7XG4gICAgICBob3RzcG90Q29udGFpbmVyLmNyZWF0ZUhvdHNwb3QoZWxlbWVudCwgeyB5YXc6IGhvdHNwb3QueWF3LCBwaXRjaDogaG90c3BvdC5waXRjaCB9KTtcbiAgICB9KTtcblxuICAgIHJldHVybiB7IHNjZW5lLCB2aWV3LCBkYXRhIH07XG4gIH1cblxuICBzd2l0Y2hTY2VuZShzY2VuZSkge1xuXG5cbiAgICBjb25zdCBhbHRlcmVkVmlld1BhcmFtcyA9IHRoaXMuZmlyc3RMb2FkID9cbiAgICAgIHNjZW5lLmRhdGEuaW5pdGlhbFZpZXdQYXJhbWV0ZXJzIDpcbiAgICAgIHRoaXMuZ2V0VHJhbnNpdGlvblJvdGF0aW9uKHRoaXMuY3VycmVudERhdGEsIHNjZW5lLmRhdGEpO1xuXG4gICAgdGhpcy5maXJzdExvYWQgPSBmYWxzZTtcblxuICAgIHNjZW5lLnZpZXcuc2V0UGFyYW1ldGVycyhhbHRlcmVkVmlld1BhcmFtcyk7XG5cbiAgICAvLyBvdmVycmlkZXMgdGhlIHRoaXMuY3VycmVudFhZWiB2YXJpYWJsZXMuXG4gICAgLy8gSSBuZWVkIHRob3NlIHZhcmlhYmxlcyBpbnRhY3QgZm9yIGFsdGVyaW5nIHRoZSBpbnRpYWwgdmlldyBwYXJhbXMgdGhvdWdoLiBTbyBkbyB0aGlzIGFmdGVyLlxuICAgIHRoaXMuY2FjaGVTY2VuZVZhcmlhYmxlcy5jYWxsKHRoaXMsIHNjZW5lKTtcbiAgICBzY2VuZS5zY2VuZS5zd2l0Y2hUbygpO1xuICB9XG5cbn1cbiIsImNvbnN0IE1hcnppcGFub1ZpZXdlciA9IHJlcXVpcmUoJy4vTWFyemlwYW5vVmlld2VyJyk7XG5jb25zdCBEZXZpY2VPcmllbnRhdGlvblN0cmF0ZWd5ID0gcmVxdWlyZSgnLi9EZXZpY2VPcmllbnRhdGlvblN0cmF0ZWd5Jyk7XG5jb25zdCB7IGRlZzJyYWQsIGNsYW1wT3ZlcmZsb3dSb3RhdGlvbiB9ID0gcmVxdWlyZSgnLi91dGlscycpO1xuY29uc29sZS5sb2coRGV2aWNlT3JpZW50YXRpb25TdHJhdGVneSk7XG5cbm1vZHVsZS5leHBvcnRzID0gY2xhc3MgVlJWaWV3ZXIgZXh0ZW5kcyBNYXJ6aXBhbm9WaWV3ZXIge1xuXG4gIGNvbnN0cnVjdG9yKHBhbm9FbGVtZW50LCBjb25maWdEYXRhKSB7XG5cbiAgICBzdXBlcignbW9iaWxlVlInLCBwYW5vRWxlbWVudCwgY29uZmlnRGF0YSk7XG5cbiAgICB0aGlzLmd5cm9FbmFibGVkO1xuICAgIHRoaXMudmlld2luZ1RpbWVvdXRJRCA9IG51bGw7XG4gICAgdGhpcy5jdXJyZW50SG90c3BvdENhbmRpZGF0ZSA9IG51bGw7XG5cbiAgICB0aGlzLm9wZW5lZEhvdHNwb3QgPSBudWxsO1xuXG4gICAgY29uc29sZS5sb2codGhpcy5EZXZpY2VPcmllbnRhdGlvblN0cmF0ZWd5KTtcblxuICAgIHRoaXMubG9va1RyaWdnZXJUaHJlc2hvbGQgPSAxLjUgKiAxMDAwO1xuICAgIHRoaXMub3BlblBvcHVwUmFkaWFuVGhyZXNoaG9sZCA9IGRlZzJyYWQoNSk7XG4gICAgLy8gVGhpcyBpcyB0aGUgc2luZ2xlIGNvbHVtbiB0aHJlc2hvbGQsIGl0IGdldHMgZG91YmxlZCB3aGVuIGV4aXRpbmcgMiBjb2x1bW4gcG9wdXBzXG4gICAgdGhpcy5jbG9zZVBvcHVwSG9yaXpvbnRhbFJhZGlhblRocmVzaGhvbGRQZXJDb2x1bW4gPSBkZWcycmFkKDE1KTtcblxuICAgIHRoaXMub3JpZW50YXRpb25NZXRob2RJRCA9ICdkZXZpY2VPcmllbnRhdGlvbic7XG5cbiAgICB0aGlzLmRldmljZU9yaWVudGF0aW9uQ29udHJvbGxlcjtcblxuICAgIGNvbnN0IGdyb3VwZWRTY2VuZURhdGEgPSB0aGlzLnNldHVwU2NlbmVCZWhhdmlvdXIodGhpcy5jcmVhdGVTY2VuZSwgdGhpcy5zd2l0Y2hTY2VuZSk7XG5cbiAgICB0aGlzLnNldHVwR3lyb0NvbnRyb2xzKGdyb3VwZWRTY2VuZURhdGEpO1xuXG4gICAgdGhpcy5zd2l0Y2hTY2VuZShncm91cGVkU2NlbmVEYXRhW3RoaXMuaW5pdGlhbFNjZW5lXSk7XG4gIH1cblxuXG4gIC8vIFNoYXJlZCBzaWduYXR1cmUgd2l0aCBEZXNrdG9wVmlld2VyLmNyZWF0ZVNjZW5lKCkgYnV0IEkgZG9uJ3QgdXNlIGl0IGFsbC5cbiAgLy8gVE9ETzogTWF5YmUgYWNjZXB0IG9wdHMgb2JqZWN0LlxuICBjcmVhdGVTY2VuZSh2aWV3ZXIsIHNvdXJjZSwgZ2VvbWV0cnksIGRhdGEpIHtcblxuICAgIGNvbnN0IHN0YWdlID0gdmlld2VyLnN0YWdlKCk7XG5cbiAgICBjb25zdCBsZWZ0UmlnaHRSZWN0cyA9IFtcbiAgICAgIHsgcmVjdDogeyByZWxhdGl2ZVdpZHRoOiAwLjUsIHJlbGF0aXZlWDogMCB9IH0sIC8vIGxlZnRcbiAgICAgIHsgcmVjdDogeyByZWxhdGl2ZVdpZHRoOiAwLjUsIHJlbGF0aXZlWDogMC41IH0gfSAgLy8gcmlnaHRcbiAgICBdO1xuXG4gICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgIHNvdXJjZTogc291cmNlLFxuICAgICAgZ2VvbWV0cnk6IGdlb21ldHJ5LFxuICAgICAgLy8gcGluRmlyc3RMZXZlbDogdHJ1ZSxcbiAgICAgIHRleHR1cmVTdG9yZU9wdHM6IHtcbiAgICAgICAgcHJldmlvdXNseVZpc2libGVDYWNoZVNpemU6IDMyXG4gICAgICB9LFxuICAgICAgbGF5ZXJPcHRzOiB7XG4gICAgICAgIGVmZmVjdHM6IG51bGxcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3QgY29udGFpbmVycyA9IFtdO1xuICAgIGNvbnN0IGxheWVycyA9IFtdO1xuXG4gICAgY29uc3QgZW1wdHlWaWV3ID0gbmV3IHRoaXMuTWFyemlwYW5vLlJlY3RpbGluZWFyVmlldyhkYXRhLmluaXRpYWxWaWV3UGFyYW1ldGVycyk7XG4gICAgY29uc3Qgc2NlbmUgPSB2aWV3ZXIuY3JlYXRlRW1wdHlTY2VuZSh7IHZpZXc6IGVtcHR5VmlldyB9KTtcblxuICAgIGxlZnRSaWdodFJlY3RzLmZvckVhY2goKHJlY3QsIGluZGV4KSA9PiB7XG5cbiAgICAgIG9wdHMubGF5ZXJPcHRzLmVmZmVjdHMgPSByZWN0O1xuICAgICAgY29uc3QgbGF5ZXIgPSBzY2VuZS5jcmVhdGVMYXllcihvcHRzKTtcblxuICAgICAgLy8gUHJvYmFibHkgZG9uJ3QgbmVlZCB0aGlzIGJ1dCBpdCBtaWdodCBiZSB1c2VmdWwgZm9yIGRlYnVnZ2luZyBvciBzdGF0ZSBjaGVja3MuXG4gICAgICBsYXllci5leWVTaWRlID0gaW5kZXggPT09IDAgPyAnbGVmdCcgOiAncmlnaHQnO1xuXG4gICAgICAvLyBBZGQgaG90c3BvdHMuXG4gICAgICBjb25zdCBob3RzcG90Q29udGFpbmVyID0gbmV3IHRoaXMuTWFyemlwYW5vLkhvdHNwb3RDb250YWluZXIoXG4gICAgICAgIHZpZXdlci5kb21FbGVtZW50KCksXG4gICAgICAgIHN0YWdlLFxuICAgICAgICBlbXB0eVZpZXcsXG4gICAgICAgIHZpZXdlci5yZW5kZXJMb29wKCksXG4gICAgICAgIHJlY3QpO1xuXG4gICAgICAvLyBDcmVhdGUgbGluayBob3RzcG90cy5cbiAgICAgIGRhdGEubGlua0hvdHNwb3RzLmZvckVhY2goKGhvdHNwb3REYXRhKSA9PiB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSBzdXBlci5jcmVhdGVMaW5rSG90c3BvdEVsZW1lbnQuY2FsbCh0aGlzLCBob3RzcG90RGF0YSwgdGhpcy5zd2l0Y2hTY2VuZSk7XG4gICAgICAgIGVsZW1lbnQuZGF0YXNldC5ob3RzcG90X3RhcmdldCA9IGhvdHNwb3REYXRhLnRhcmdldDtcbiAgICAgICAgaG90c3BvdENvbnRhaW5lci5jcmVhdGVIb3RzcG90KGVsZW1lbnQsIHsgeWF3OiBob3RzcG90RGF0YS55YXcsIHBpdGNoOiBob3RzcG90RGF0YS5waXRjaCB9KTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDcmVhdGUgaW5mbyBob3RzcG90cy5cbiAgICAgIGRhdGEuaW5mb0hvdHNwb3RzLmZvckVhY2goKGhvdHNwb3REYXRhKSA9PiB7XG4gICAgICAgIGlmIChob3RzcG90RGF0YS5oaWRlSW5WUikge1xuICAgICAgICAgIHJldHVybjsgLy8gV2UncmUgaW4gYSAuZm9yRWFjaCBmdW5jdGlvbiBzbyB3ZSByZXR1cm4gaW5zdGVhZCBvZiBjb250aW51ZVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSBzdXBlci5jcmVhdGVJbmZvSG90c3BvdEVsZW1lbnQuY2FsbCh0aGlzLCBob3RzcG90RGF0YSwgbGF5ZXIpO1xuICAgICAgICBlbGVtZW50LmRhdGFzZXQuaG90c3BvdF90YXJnZXQgPSBob3RzcG90RGF0YS5pZDtcbiAgICAgICAgaG90c3BvdENvbnRhaW5lci5jcmVhdGVIb3RzcG90KGVsZW1lbnQsIHsgeWF3OiBob3RzcG90RGF0YS55YXcsIHBpdGNoOiBob3RzcG90RGF0YS5waXRjaCB9KTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBIaWRlIGFsbCBjb250YWluZXJzIGF0IGZpcnN0LlxuICAgICAgaG90c3BvdENvbnRhaW5lci5oaWRlKCk7XG4gICAgICBjb250YWluZXJzLnB1c2goaG90c3BvdENvbnRhaW5lcik7XG4gICAgICBsYXllcnMucHVzaChsYXllcik7XG4gICAgfSk7XG5cbiAgICBpZiAoZGF0YS5pZCA9PT0gJ3NjZW5lLTAnKSB7XG4gICAgICB0aGlzLnNob3dIb3RzcG90WmVybyhjb250YWluZXJzKTtcbiAgICB9XG5cbiAgICAvLyBTaG91bGQgcHJvYmFibHkgYWx0ZXIgdGhpcyB0byBnZXQgdGhlIGhvdHNwb3RzIHlhdyBhbmQgcGl0Y2ggZm9ybSB0aGUgY29udGFpbmVyLmxpc3RIb3RzcG90cygpLlxuXG4gICAgLy8gQWRkIGEgbGl0dGxlIGV4dHJhIGRhdGEgZm9yIHVzaW5nIGluIHZpZXcgY29sbGlzaW9uIGNoZWNrcy5cblxuICAgIGNvbnN0IGluZm9EYXRhID0gZGF0YS5pbmZvSG90c3BvdHNcbiAgICAgIC5maWx0ZXIoaWggPT4gT2JqZWN0LmtleXMoaWgpLmluY2x1ZGVzKCdoaWRlSW5WUicpID09PSBmYWxzZSlcbiAgICAgIC8vIFdlIGRvbid0IHdhbnQgY29sbGlzaW9ucyB3aXRoIGhvdHNwb3QgMCAodGhlIHR1dG9yaWFsKVxuICAgICAgLmZpbHRlcihpaCA9PiBpaC5pZCAhPT0gJzAnKVxuICAgICAgLm1hcChpaCA9PiB7IHJldHVybiB7IHlhdzogaWgueWF3LCBwaXRjaDogaWgucGl0Y2gsIHRhcmdldDogaWguaWQsIGNvbHVtbnM6IGloLmNvbHVtbnMgfHwgMSB9OyB9KTtcblxuICAgIGNvbnN0IGxpbmtEYXRhID0gZGF0YS5saW5rSG90c3BvdHMubWFwKGxoID0+IHsgcmV0dXJuIHsgeWF3OiBsaC55YXcsIHBpdGNoOiBsaC5waXRjaCwgdGFyZ2V0OiBsaC50YXJnZXQgfTsgfSk7XG5cbiAgICBkYXRhLnZyQ29sbGlzaW9uRGF0YSA9IFsuLi5pbmZvRGF0YSwgLi4ubGlua0RhdGFdO1xuXG4gICAgLy8gVXNlZnVsIGxhdGVyIGZvciBkZWNpZGluZyB3aGVyZSB0byBjZW50ZXIgdGhlIHZpZXcgb24gc2NlbmUgY2hhbmdlLlxuICAgIGRhdGEuZmlyc3RMb2FkID0gdHJ1ZTtcblxuICAgIC8vIEdldHMgZGVjb25zdHJ1Y3RlZCBvbiB0aGUgb3RoZXIgc2lkZS5cbiAgICByZXR1cm4geyBzY2VuZTogc2NlbmUsIHZpZXc6IGVtcHR5VmlldywgY29udGFpbmVycywgbGF5ZXJzLCBkYXRhIH07XG4gIH1cblxuXG4gIHNob3dIb3RzcG90WmVybyhjb250YWluZXJzKSB7XG5cbiAgICBjb25zdCB7IGxlZnRIb3RzcG90IH0gPSB0aGlzLmdldEhvdHNwb3RzRnJvbUhvdHNwb3RUYXJnZXQoY29udGFpbmVycywgJzAnKTtcbiAgICBjb25zdCBsZWZ0RWxlbWVudCA9IGxlZnRIb3RzcG90LmRvbUVsZW1lbnQoKTtcbiAgICB0aGlzLmNsaWNrSW5mb0hvdHNwb3QobGVmdEVsZW1lbnQpO1xuXG4gIH1cblxuXG4gIHN3aXRjaFNjZW5lKHNjZW5lKSB7XG5cbiAgICAvLyBTd2l0Y2ggdGhlIGN1cnJlbnQgY29udGFpbmVycy5cbiAgICAvLyBJIHdvdWxkIHByZWZlciB0byBkaXJlY3RseSBzaG93IGFuZCBoaWRlIGVsZW1lbnRzIFswXSBhbmQgWzFdIGZyb20gdGhlIHJlc3BlY3RpdmUgYXJyYXlzLlxuICAgIC8vIEhvd2V2ZXIgd2hlbiBsb2FkaW5nIHRoZSBhcHAgYHRoaXMuY3VycmVudENvbnRhaW5lcnNgIGlzIGVtcHR5IHdoZW4gSSdtIHByZXR0eSBzdXJlIGl0IHNob3VsZCBiZSBwb3B1bGF0ZWQuXG4gICAgLy8gSSBjYW4gb25seSBhc3N1bWUgaXQncyBhIGB0aGlzYCBpc3N1ZSBvciBzb21lIHdvbmt5IHN0YXRlLiBTbyB0byBiZSBzYWZlIEknbSBzdGlja2luZyB0byBgQXJyYXkuZm9yRWFjaCgpYFxuICAgIHRoaXMuY3VycmVudENvbnRhaW5lcnMuZm9yRWFjaChjID0+IHtcbiAgICAgIGMuaGlkZSgpO1xuICAgIH0pO1xuICAgIHNjZW5lLmNvbnRhaW5lcnMuZm9yRWFjaChjID0+IHtcbiAgICAgIGMuc2hvdygpO1xuICAgIH0pO1xuXG4gICAgLy8gQ2xlYXIgYW55IGhvdHNwb3QgbG9va2luZyB0aW1lcnMuXG4gICAgY2xlYXJUaW1lb3V0KHRoaXMudmlld2luZ1RpbWVvdXRJRCk7XG4gICAgdGhpcy52aWV3aW5nVGltZW91dElEID0gbnVsbDtcblxuXG4gICAgY29uc3QgYWx0ZXJlZFZpZXdQYXJhbXMgPSB0aGlzLmdldFRyYW5zaXRpb25Sb3RhdGlvbih0aGlzLmN1cnJlbnREYXRhLCBzY2VuZS5kYXRhKTtcblxuICAgIHNjZW5lLnZpZXcuc2V0UGFyYW1ldGVycyhhbHRlcmVkVmlld1BhcmFtcyk7XG5cbiAgICAvLyBvdmVycmlkZXMgdGhlIHRoaXMuY3VycmVudFhZWiB2YXJpYWJsZXMuIFxuICAgIC8vIEkgbmVlZCB0aG9zZSB2YXJpYWJsZXMgaW50YWN0IGZvciBhbHRlcmluZyB0aGUgaW50aWFsIHZpZXcgcGFyYW1zIHRob3VnaC4gU28gZG8gdGhpcyBhZnRlci5cbiAgICB0aGlzLmNhY2hlU2NlbmVWYXJpYWJsZXMuY2FsbCh0aGlzLCBzY2VuZSk7XG5cbiAgICBzY2VuZS5zY2VuZS5zd2l0Y2hUbyh7fSwgKCkgPT4ge1xuICAgICAgLy8gVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgd2hlbiBzY2VuZSB0cmFuc2l0aW9uIGZpbmlzaGVzLiBNYXliZSBpdCB3aWxsIGJlIHVzZWZ1bCBsYXRlcj9cbiAgICAgIC8vIEVzcGVjaWFsbHkgaWYgd2Ugd2FudCB0byBhbHRlciB0aGUgaW5pdGlhbCB2aWV3IHJvdGF0aW9uIGJ5IG91ciBwcmV2aW91cyBzY2VuZXMgdmFsdWVzLlxuICAgIH0pO1xuXG4gIH1cblxuXG4gIC8vIENvdWxkIHBhc3MgaW4gdGhlIGRldmljZU9yaWVudGF0aW9uQ29udHJvbEZ1bmN0aW9uXG4gIHNldHVwR3lyb0NvbnRyb2xzKGdyb3VwZWRTY2VuZURhdGEpIHtcblxuICAgIHRoaXMuZGV2aWNlT3JpZW50YXRpb25Db250cm9sbGVyID0gbmV3IERldmljZU9yaWVudGF0aW9uU3RyYXRlZ3kodGhpcy5NYXJ6aXBhbm8pO1xuICAgIHRoaXMuTWFyemlwYW5vLmRlcGVuZGVuY2llcy5ldmVudEVtaXR0ZXIoRGV2aWNlT3JpZW50YXRpb25TdHJhdGVneSk7XG4gICAgLy8gUmVnaXN0ZXIgdGhlIGN1c3RvbSBjb250cm9sIG1ldGhvZC4gIFxuICAgIGNvbnN0IGluc3RhbnRFbmFibGUgPSB0cnVlO1xuICAgIHRoaXMudmlld2VyLmNvbnRyb2xzKCkucmVnaXN0ZXJNZXRob2QodGhpcy5vcmllbnRhdGlvbk1ldGhvZElELCB0aGlzLmRldmljZU9yaWVudGF0aW9uQ29udHJvbGxlciwgaW5zdGFudEVuYWJsZSk7XG5cbiAgICB0aGlzLmRldmljZU9yaWVudGF0aW9uQ29udHJvbGxlci5hZGRFdmVudExpc3RlbmVyKCd1cGRhdGVkWWF3UGl0Y2hSb2xsJywgKF8sIHJvdGF0aW9uKSA9PiB7XG5cbiAgICAgIC8vIGlmICh0aGlzLnN3aXRjaGluZ1NjZW5lcykgeyByZXR1cm47IH1cbiAgICAgIHRoaXMuY29tcHV0ZUxvb2tEaXJlY3Rpb24uY2FsbCh0aGlzLCByb3RhdGlvbiwgdGhpcy5jdXJyZW50U2NlbmUsIHRoaXMuY3VycmVudFZpZXcpO1xuICAgIH0pO1xuXG4gICAgLy8gRm9yIHRlc3RpbmcgdmlldyBkaXJlY3Rpb24gb24gZGVza3RvcCBvbmx5XG4gICAgLy8gVGhpcyBpcyBhbHNvIHVzZWZ1bCBpZiB5b3Ugd2FudCB0byBrbm93IHRoZSB5YXcgYW5kIHBpdGNoIGZvciBwbGFjaW5nIGRlc2t0b3BcbiAgICAvLyBncm91cGVkU2NlbmVEYXRhLmZvckVhY2goZ3NkID0+IHtcbiAgICAvLyAgICAgZ3NkLnZpZXcuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4ge1xuXG4gICAgLy8gICAgICAgICB0aGlzLmNvbXB1dGVMb29rRGlyZWN0aW9uLmNhbGwodGhpcywgbnVsbCwgdGhpcy5jdXJyZW50U2NlbmUsIHRoaXMuY3VycmVudFZpZXcpO1xuICAgIC8vICAgICB9KTtcbiAgICAvLyB9KVxuICB9XG5cblxuICAvKipcbiAgICogSSB3b3JyeSB0aGF0IHRoaXMgaXNuJ3QgdGFyZ2V0dGluZyB0aGUgcmlnaHQgZWxlbWVudHMuLi4uXG4gICAqIFxuICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9uIFxuICAgKi9cbiAgc2V0VGltZXJDbGFzcyhvbikge1xuICAgIHRoaXMucGFub0VsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZSgnaXMtb3BlbmluZycsIG9uKTtcbiAgfVxuXG5cbiAgY2xpY2tJbmZvSG90c3BvdChlbGVtZW50KSB7XG4gICAgZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuaW5mby1ob3RzcG90LWhlYWRlcicpLmNsaWNrKCk7XG4gIH1cblxuXG4gIGNsaWNrTGlua0hvdHNwb3QoZWxlbWVudCkge1xuICAgIGVsZW1lbnQucXVlcnlTZWxlY3RvcignLmxpbmstaG90c3BvdCcpLmNsaWNrKCk7XG4gIH1cblxuXG4gIG1pbmltdW1Mb29rQXRCb3VuZHMoc3BvdCwgcGFyYW1zKSB7XG5cbiAgICBjb25zdCB5YXdEaWZmID0gc3BvdC55YXcgLSBwYXJhbXMueWF3O1xuICAgIGNvbnN0IHBpdGNoRGlmZiA9IHNwb3QucGl0Y2ggLSBwYXJhbXMucGl0Y2g7XG4gICAgY29uc3QgbG9va0F0VXBwZXJCb3VuZCA9IHlhd0RpZmYgPCB0aGlzLm9wZW5Qb3B1cFJhZGlhblRocmVzaGhvbGQgJiYgcGl0Y2hEaWZmIDwgdGhpcy5vcGVuUG9wdXBSYWRpYW5UaHJlc2hob2xkO1xuICAgIGNvbnN0IGxvb2tBdExvd2VyQm91bmQgPSB5YXdEaWZmID4gLXRoaXMub3BlblBvcHVwUmFkaWFuVGhyZXNoaG9sZCAmJiBwaXRjaERpZmYgPiAtdGhpcy5vcGVuUG9wdXBSYWRpYW5UaHJlc2hob2xkO1xuXG4gICAgcmV0dXJuIHsgeWF3RGlmZiwgcGl0Y2hEaWZmLCBsb29rQXRVcHBlckJvdW5kLCBsb29rQXRMb3dlckJvdW5kIH07XG4gIH1cblxuXG4gIG1pbmltdW1Mb29rQXdheUJvdW5kcyhzcG90LCBwYXJhbXMpIHtcblxuICAgIC8vIEdvdHRhIG5vcm1hbGlzZSB0aGUgeWF3IGRpZmYgYSBiaXRcbiAgICBjb25zdCB5YXdEaWZmID0gY2xhbXBPdmVyZmxvd1JvdGF0aW9uKHNwb3QueWF3IC0gcGFyYW1zLnlhdyk7XG5cbiAgICAvLyA+IDwgaXMgZmxpcHBlZCBmcm9tIHRoZSB7bG9va0F0fSBib3VuZHNcbiAgICAvLyB3ZSdyZSB0cnlpbmcgdG8gZ2V0IEZVUlRIRVIgQVdBWSB0byBjbG9zZSwgbm90IENMT1NFIEVOT1VHSCB0byBvcGVuXG4gICAgY29uc3QgbG9va0F3YXlNaW5pbXVtVXBwZXJCb3VuZCA9IHlhd0RpZmYgPiB0aGlzLmNsb3NlUG9wdXBIb3Jpem9udGFsUmFkaWFuVGhyZXNoaG9sZFBlckNvbHVtbiAqIHNwb3QuY29sdW1ucztcbiAgICBjb25zdCBsb29rQXdheU1pbmltdW1Mb3dlckJvdW5kID0geWF3RGlmZiA8IC10aGlzLmNsb3NlUG9wdXBIb3Jpem9udGFsUmFkaWFuVGhyZXNoaG9sZFBlckNvbHVtbiAqIHNwb3QuY29sdW1ucztcblxuICAgIHJldHVybiB7IHlhd0RpZmYsIGxvb2tBd2F5TWluaW11bVVwcGVyQm91bmQsIGxvb2tBd2F5TWluaW11bUxvd2VyQm91bmQgfTtcbiAgfVxuXG5cbiAgLy8gQnkgdXNpbmcgcHJvdG90eXBlLmNhbGwoKSB7dGhpc30gd2lsbCBiZSB0aGUgbm9ybWFsIGNsYXNzIHNjb3BlIGFuZCBoYXZlIGFjY2VzcyB0byBjbGFzcyB2YXJpYWJsZXMuXG4gIGNvbXB1dGVMb29rRGlyZWN0aW9uKHJvdGF0aW9uLCBjdXJyZW50U2NlbmUsIGN1cnJlbnRWaWV3KSB7XG5cbiAgICAvLyBwaXRjaCwgcm9sbCBhbmQgeWF3IGluIHJhZGlhbnNcbiAgICBjb25zdCBwYXJhbXMgPSBjdXJyZW50Vmlldy5wYXJhbWV0ZXJzKCk7XG5cbiAgICAvLyBOb3RoaW5nIHNlbGVjdGVkIG9yIGN1cnJlbnRseSBzZWxlY3RpbmcuIEdvIGZpbmQgYSBob3RzcG90XG4gICAgaWYgKCF0aGlzLmN1cnJlbnRIb3RzcG90Q2FuZGlkYXRlICYmICF0aGlzLm9wZW5lZEhvdHNwb3QpIHtcbiAgICAgIC8vIEhhdmVuJ3QgZm91bmQgYW5kIG9wZW5lZCBhIGhvdHNwb3QgeWV0LlxuICAgICAgLy8gTGV0cyBnbyBsb29raW5nIGZvciBvbmUuXG4gICAgICBsZXQgaG90c3BvdHMgPSB0aGlzLmN1cnJlbnREYXRhLnZyQ29sbGlzaW9uRGF0YTtcblxuICAgICAgLy8gTG9vcHMgdGhlIGhvdHNwb3RzLCBsb29rIGZvciBvbmUgd2l0aCBhIGNsb3NlIGVub3VnaCBwaXRjaCBhbmQgeWF3LCBzZWxlY3QgdGhhdCBhcyB0aGUgY2FuZGlkYXRlXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhvdHNwb3RzLmxlbmd0aDsgaSsrKSB7XG5cbiAgICAgICAgaWYgKHRoaXMuY3VycmVudEhvdHNwb3RDYW5kaWRhdGUpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHNwb3QgPSBob3RzcG90c1tpXTtcbiAgICAgICAgLy8gY29tcHV0ZSBhIHJvdGF0aW9uIGRpZmZlcmVuY2VcbiAgICAgICAgY29uc3QgeyB5YXdEaWZmLCBwaXRjaERpZmYsIGxvb2tBdFVwcGVyQm91bmQsIGxvb2tBdExvd2VyQm91bmQgfSA9IHRoaXMubWluaW11bUxvb2tBdEJvdW5kcyhzcG90LCBwYXJhbXMpO1xuXG4gICAgICAgIC8vIElmIHRoYXQgZGlmZmVyZW5jZSBpcyB3aXRoaW4gYSB0b2xlcmFuY2UgdGhlbiBpbnRlcmFjdCB3aXRoIHRoZSBlbGVtZW50LlxuICAgICAgICBpZiAobG9va0F0VXBwZXJCb3VuZCAmJiBsb29rQXRMb3dlckJvdW5kKSB7XG5cbiAgICAgICAgICB0aGlzLmN1cnJlbnRIb3RzcG90Q2FuZGlkYXRlID0gc3BvdDtcblxuICAgICAgICAgIC8vIEhhdmUgd2UgYmVndW4gbG9va2luZyBhdCBhbnkgaG90c3BvdCB5ZXQ/XG4gICAgICAgICAgaWYgKCF0aGlzLnZpZXdpbmdUaW1lb3V0SUQpIHtcblxuICAgICAgICAgICAgdGhpcy5zZXRUaW1lckNsYXNzKHRydWUpO1xuXG4gICAgICAgICAgICB0aGlzLnZpZXdpbmdUaW1lb3V0SUQgPSBzZXRUaW1lb3V0KCgpID0+IHtcblxuICAgICAgICAgICAgICBjb25zdCB7IGxlZnRIb3RzcG90LCByaWdodEhvdHNwb3QgfSA9IHRoaXMuZ2V0SG90c3BvdHNGcm9tSG90c3BvdFRhcmdldCh0aGlzLmN1cnJlbnRDb250YWluZXJzLCB0aGlzLmN1cnJlbnRIb3RzcG90Q2FuZGlkYXRlLnRhcmdldCk7XG4gICAgICAgICAgICAgIGNvbnN0IGxlZnRFbGVtZW50ID0gbGVmdEhvdHNwb3QuZG9tRWxlbWVudCgpO1xuXG4gICAgICAgICAgICAgIHRoaXMuc2V0VGltZXJDbGFzcyhmYWxzZSk7XG4gICAgICAgICAgICAgIHRoaXMudmlld2luZ1RpbWVvdXRJRCA9IG51bGw7XG5cbiAgICAgICAgICAgICAgLy8gdGhpcy5jdXJyZW50SG90c3BvdENhbmRpZGF0ZSA9IG51bGw7XG5cbiAgICAgICAgICAgICAgLy8gSXMgaXQgYW4gbGluayBvciBpbmZvIGhvdHNwb3Q/XG4gICAgICAgICAgICAgIGlmIChsZWZ0RWxlbWVudC5kYXRhc2V0LmhvdHNwb3RfdGFyZ2V0LmluY2x1ZGVzKCdzY2VuZScpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcGVuZWRIb3RzcG90ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLmNsaWNrTGlua0hvdHNwb3QobGVmdEVsZW1lbnQpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMub3BlbmVkSG90c3BvdCA9IHNwb3Q7XG4gICAgICAgICAgICAgICAgdGhpcy5jbGlja0luZm9Ib3RzcG90KGxlZnRFbGVtZW50KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgdGhpcy5sb29rVHJpZ2dlclRocmVzaG9sZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICB9XG4gICAgLy8gV2UgaGF2ZSBhIGNhbmRpZGF0ZSBhbmQgd2UncmUgY3VycmVudGx5IGNvdW50aW5nIGRvd24uIENoZWNrIGZvciBsb29rIGF3YXkgZHVyaW5nIHRoaXMgdGltZS5cbiAgICBlbHNlIGlmICh0aGlzLmN1cnJlbnRIb3RzcG90Q2FuZGlkYXRlICYmICF0aGlzLm9wZW5lZEhvdHNwb3QpIHtcblxuICAgICAgY29uc3Qgc3BvdCA9IHRoaXMuY3VycmVudEhvdHNwb3RDYW5kaWRhdGU7XG5cbiAgICAgIC8vIGNvbXB1dGUgYSByb3RhdGlvbiBkaWZmZXJlbmNlXG4gICAgICBjb25zdCB7IHlhd0RpZmYsIHBpdGNoRGlmZiwgbG9va0F0VXBwZXJCb3VuZCwgbG9va0F0TG93ZXJCb3VuZCB9ID0gdGhpcy5taW5pbXVtTG9va0F0Qm91bmRzKHNwb3QsIHBhcmFtcyk7XG5cbiAgICAgIC8vIEFyZSB3ZSBub3cgbG9va2luZyBhd2F5IGZyb20gdGhlIGNhbmRpZGF0ZT9cbiAgICAgIGlmICghbG9va0F0VXBwZXJCb3VuZCB8fCAhbG9va0F0TG93ZXJCb3VuZCkge1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy52aWV3aW5nVGltZW91dElEKTtcbiAgICAgICAgLy8gVGhlIGNsZWFyVGllbW91dCBmdW5jdGlvbiBkb2Vzbid0IHJlc2V0IHRoZSB2YXJpYWJsZSB0byBzb21ldGhpbmcgc2FmZS5cbiAgICAgICAgdGhpcy52aWV3aW5nVGltZW91dElEID0gbnVsbDtcbiAgICAgICAgdGhpcy5vcGVuZWRIb3RzcG90ID0gbnVsbDtcbiAgICAgICAgdGhpcy5jdXJyZW50SG90c3BvdENhbmRpZGF0ZSA9IG51bGw7XG4gICAgICAgIHRoaXMuc2V0VGltZXJDbGFzcyhmYWxzZSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gQSBob3RzcG90IGhhcyBiZWVuIG9wZW5lZCwgbm93IHN0YXJ0IHRyeWluZyB0byBjbG9zZSBpdC5cbiAgICBlbHNlIGlmICh0aGlzLm9wZW5lZEhvdHNwb3QpIHtcblxuICAgICAgY29uc3Qgc3BvdCA9IHRoaXMub3BlbmVkSG90c3BvdDtcblxuICAgICAgY29uc3QgeyB5YXdEaWZmLCBsb29rQXdheU1pbmltdW1VcHBlckJvdW5kLCBsb29rQXdheU1pbmltdW1Mb3dlckJvdW5kIH0gPSB0aGlzLm1pbmltdW1Mb29rQXdheUJvdW5kcyhzcG90LCBwYXJhbXMpO1xuXG4gICAgICBpZiAobG9va0F3YXlNaW5pbXVtTG93ZXJCb3VuZCB8fCBsb29rQXdheU1pbmltdW1VcHBlckJvdW5kKSB7XG5cbiAgICAgICAgY29uc3QgeyBsZWZ0SG90c3BvdCwgcmlnaHRIb3RzcG90IH0gPSB0aGlzLmdldEhvdHNwb3RzRnJvbUhvdHNwb3RUYXJnZXQodGhpcy5jdXJyZW50Q29udGFpbmVycywgc3BvdC50YXJnZXQpO1xuICAgICAgICBjb25zdCBsZWZ0RWxlbWVudCA9IGxlZnRIb3RzcG90LmRvbUVsZW1lbnQoKTtcblxuICAgICAgICB0aGlzLmNsaWNrSW5mb0hvdHNwb3QobGVmdEVsZW1lbnQpO1xuICAgICAgICAvLyBSZXNldCB2YXJpb3VzIGNhY2hlZCB2YXJpYWJsZXNcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudmlld2luZ1RpbWVvdXRJRCk7XG4gICAgICAgIHRoaXMudmlld2luZ1RpbWVvdXRJRCA9IG51bGw7XG4gICAgICAgIHRoaXMub3BlbmVkSG90c3BvdCA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0SG90c3BvdHNGcm9tSG90c3BvdFRhcmdldChjb250YWluZXJzLCB0YXJnZXQpIHtcblxuICAgIGNvbnN0IGhvdHNwb3RzID0gWy4uLmNvbnRhaW5lcnNbMF0ubGlzdEhvdHNwb3RzKCldO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBob3RzcG90cy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgZCA9IGhvdHNwb3RzW2ldLmRvbUVsZW1lbnQoKTtcblxuICAgICAgaWYgKGQuZGF0YXNldC5ob3RzcG90X3RhcmdldCA9PSB0YXJnZXQpIHtcbiAgICAgICAgY29uc3QgbGVmdCA9IGhvdHNwb3RzW2ldO1xuICAgICAgICBjb25zdCByaWdodCA9IGNvbnRhaW5lcnNbMV0ubGlzdEhvdHNwb3RzKClbaV07XG4gICAgICAgIHJldHVybiB7IGxlZnRIb3RzcG90OiBsZWZ0LCByaWdodEhvdHNwb3Q6IHJpZ2h0IH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gVGhyb3cgYW4gZXJyb3IsIGRvbid0IGNhdGNoIGl0LiBUaGlzIGlzIGEgY3Jhc2hpbmcgZXJyb3IuXG4gICAgY29uc29sZS5lcnJvcignbm8gaG90c3BvdCBmb3VuZD8nKTtcbiAgfVxuXG59XG4iXX0=
